{{ define "main" }}
<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 pt-12 pb-20">
  <!-- Tags -->
  <div class="mb-4 flex flex-wrap gap-2">
    {{ range .Params.tags }}
    <a href="{{ $.Site.Home.RelPermalink }}?tag={{ . }}" class="inline-block bg-primary/10 text-primary text-sm font-semibold px-3 py-1 rounded no-underline hover:bg-primary/20 transition-colors">{{ . }}</a>
    {{ end }}
  </div>

  <!-- Title -->
  <h1 class="text-4xl font-bold text-gray-900 dark:text-gray-100 mb-4 leading-tight">{{ .Title }}</h1>

  <!-- Date -->
  <time class="text-gray-400 dark:text-gray-500 text-sm">{{ .Date.Format "2006. 01. 02" }}</time>

  <!-- Featured image -->
  {{ with .Resources.GetMatch .Params.image }}
  <div class="mt-8 rounded-2xl overflow-hidden">
    <img src="{{ .RelPermalink }}" alt="{{ $.Title }}" class="w-full object-cover">
  </div>
  {{ else }}{{ with .Params.image }}
  <div class="mt-8 rounded-2xl overflow-hidden">
    <img src="{{ . }}" alt="{{ $.Title }}" class="w-full object-cover">
  </div>
  {{ end }}{{ end }}

  <!-- Content -->
  <div class="mt-10 prose prose-sm dark:prose-invert max-w-none
    prose-headings:text-gray-900 dark:prose-headings:text-gray-100 prose-headings:font-bold
    prose-p:text-gray-700 dark:prose-p:text-gray-300 prose-p:leading-relaxed
    prose-a:text-primary prose-a:no-underline hover:prose-a:underline
    prose-strong:text-gray-900 dark:prose-strong:text-gray-100
    prose-ul:text-gray-700 dark:prose-ul:text-gray-300 prose-ol:text-gray-700 dark:prose-ol:text-gray-300
    prose-li:marker:text-primary
    prose-blockquote:border-primary prose-blockquote:text-gray-600 dark:prose-blockquote:text-gray-400
    prose-code:text-primary prose-code:bg-gray-50 dark:prose-code:bg-gray-800 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded prose-code:text-sm prose-code:before:content-none prose-code:after:content-none
    prose-pre:bg-gray-900 dark:prose-pre:bg-gray-800 prose-pre:text-gray-100 prose-pre:rounded-xl
    prose-img:rounded-xl prose-img:shadow-md">
    {{ .Content }}
  </div>
</div>
{{ end }}

{{ define "scripts" }}
<style>
  aside {
    background: #f0f7ff;
    border-left: 4px solid #4374D9;
    border-radius: 0.75rem;
    padding: 1.25rem 1.5rem;
    margin: 1.5rem 0;
  }
  .dark aside {
    background: #1a2332;
  }
  aside p { margin: 0.25rem 0; }
  img.plain { border-radius: 0 !important; box-shadow: none !important; }
  .dark img.invertable { filter: invert(1) hue-rotate(180deg); }
  /* 코드블럭 공통 스타일 */
  pre:not(.mermaid),
  .highlight pre {
    background: #f8f9fb !important;
    border: 1px solid #e2e6ea;
    border-radius: 0.75rem;
    padding: 1.25rem 1.5rem;
    margin-bottom: 0;
  }
  .dark pre:not(.mermaid),
  .dark .highlight pre {
    background: #1e2736 !important;
    border-color: #2d3a4a;
  }
  .highlight { margin: 1.5rem 0; }
  pre:not(.mermaid) > code,
  .highlight pre code {
    color: #374151 !important;
    background: transparent !important;
    font-size: 0.875rem;
    line-height: 1.7;
    display: block;
    white-space: pre;
    overflow-x: auto;
  }
  .dark pre:not(.mermaid) > code,
  .dark .highlight pre code {
    color: #d1d5db !important;
  }
  /* 구문 강조 색상 (light) */
  .chroma .k, .chroma .kn, .chroma .kd, .chroma .kc { color: #8b5cf6; }    /* keyword */
  .chroma .nn, .chroma .nc { color: #2563eb; }                               /* module/class */
  .chroma .nf, .chroma .fm { color: #059669; }                               /* function */
  .chroma .s, .chroma .s1, .chroma .s2, .chroma .sa { color: #d97706; }     /* string */
  .chroma .c, .chroma .c1, .chroma .ch, .chroma .cm { color: #9ca3af; font-style: italic; } /* comment */
  .chroma .nb { color: #0891b2; }                                            /* builtin */
  .chroma .mi, .chroma .mf { color: #e11d48; }                              /* number */
  .chroma .nd { color: #8b5cf6; }                                            /* decorator */
  .chroma .o, .chroma .p { color: #374151; }                                 /* operator/punctuation */
  .chroma .n { color: #374151; }                                             /* name */
  /* 구문 강조 색상 (dark) */
  .dark .chroma .k, .dark .chroma .kn, .dark .chroma .kd, .dark .chroma .kc { color: #a78bfa; }
  .dark .chroma .nn, .dark .chroma .nc { color: #60a5fa; }
  .dark .chroma .nf, .dark .chroma .fm { color: #34d399; }
  .dark .chroma .s, .dark .chroma .s1, .dark .chroma .s2, .dark .chroma .sa { color: #fbbf24; }
  .dark .chroma .c, .dark .chroma .c1, .dark .chroma .ch, .dark .chroma .cm { color: #6b7280; }
  .dark .chroma .nb { color: #22d3ee; }
  .dark .chroma .mi, .dark .chroma .mf { color: #fb7185; }
  .dark .chroma .nd { color: #a78bfa; }
  .dark .chroma .o, .dark .chroma .p { color: #d1d5db; }
  .dark .chroma .n { color: #d1d5db; }
  /* 코드블럭 마지막 빈 줄 제거 */
  pre code::after { display: none; }
  .mermaid { background: #f9fafb; border-radius: 0.75rem; padding: 1.5rem; margin: 1.5rem 0; text-align: center; }
  .dark .mermaid { background: #111827; }
</style>
<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
  var isDark = document.documentElement.classList.contains('dark');
  mermaid.initialize({ startOnLoad: true, theme: isDark ? 'dark' : 'neutral' });
</script>
{{ end }}
